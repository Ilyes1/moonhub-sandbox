
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="style.css">

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            emailjs.init("Yr7bjEWQskDUBCsEc");
        })();
    </script>

    <title>Moonhub | Explore Jobs</title>
</head>
<body>
    
    <nav class="explore-nav active">
        <div class="nav-left">
            <a href="index.html"><img src="images/logo.png" alt=""></a>
        </div>
        <div class="nav-right">
            <ul>
                <li><a href="profile.html">Profile</a></li>
                <li><a href="explore.html">Discover</a></li>
                <li class="blue-navlink"><a href="index.html">Matches</a></li>
                <li class="menu-btn"><img src="assets/icons/menu.png" alt=""></li>
            </ul>
        </div>
    </nav>

    <div class="explore-mobile-menu active">
        <ul>
            <li>
                <form class="search-container">
                    <input type="text" class="search-input">
                    <button type="submit" class="search-btn"><img src="assets/icons/search.png" alt=""></button>
                </form>
            </li>
            <li><a href="profile.html">Profile</a></li>
            <li><a href="explore.html">Discover</a></li>
            <li class="blue-navlink"><a href="index.html">Matches</a></li>
        </ul>
    </div>


    <section class="agent">

        <h2 class="agent-title">Your Moonhub Agent</h2>

        <div class="agent-container">

            <div class="agent-profile">
                <img src="images/agent.jpg" alt="">
                <div class="agent-details">
                    <strong>Nancy Xu</strong>
                    <p>CEO @ Moonhub, Stanford Alum & VC</p>
                </div>
            </div>
            <div class="agent-desc">
                Hi <span class="userName"></span>, great meeting you! Happy adventuring. Iâ€™m here if you have any questions or want to discuss opportunities in more detail. 
            </div>

            <span class="mailto-btn" style="margin-left: 30px;">
                <svg class="default" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 0H0V9L10.5743 24V16.5H21C22.6567 16.5 24 15.1567 24 13.5V3C24 1.34325 22.6567 0 21 0ZM7.5
                    9.75C6.672 9.75 6 9.07875 6 8.25C6 7.42125 6.672 6.75 7.5 6.75C8.328 6.75 9 7.42125 9 8.25C9 9.07875 8.328 9.75
                    7.5 9.75ZM12.75 9.75C11.922 9.75 11.25 9.07875 11.25 8.25C11.25 7.42125 11.922 6.75 12.75 6.75C13.578 6.75 14.25
                    7.42125 14.25 8.25C14.25 9.07875 13.578 9.75 12.75 9.75ZM18 9.75C17.172 9.75 16.5 9.07875 16.5 8.25C16.5 7.42125
                    17.172 6.75 18 6.75C18.828 6.75 19.5 7.42125 19.5 8.25C19.5 9.07875 18.828 9.75 18 9.75Z" fill="#FFFFFF"></path>
                  </svg>
                </span>

        </div>

    </section>
    
    <section class="jobs-container matches-jobs">

        <div class="jobs-tabs">
            <span data-tab=".user-news" class="active">Suggestions</span>
            <span data-tab=".user-matches">Active</span>
            <span data-tab=".user-past">Past</span>
        </div>
        
        <div class="user-jobs user-news">
            
            <h2 class="jobs-title">Suggested Opportunities for You</h2>
            <h5 class="user-jobs-subtitle">Click Request Introduction to get an email introduction to the hiring manager. All introductions are made immediately after the startup approves the request (typically within < 1 day!). You can update this curated list by changing your preferences in your <a href="profile.html">Profile</a>.</h5>

            <div class="jobs-items">
                
            </div>

        </div>
        
        <div class="user-jobs user-matches" hidden>
            
            <h2 class="jobs-title">Active Rocketships</h2>
            <h5 class="user-jobs-subtitle">* Please update status of opportunities based on conversations.</h5>

            <div class="jobs-items">
                <!-- <div role-filter="true" stage-filter="true" sector-filter="true" location-filter="true" data-remote="${snapshot.val().remote}" class="jobs-item user-job ${snapshot.val().roleFilter} ${snapshot.val().locationFilter} ${snapshot.val().sectorFilter} ${snapshot.val().stageFilter}">
                    <div class="user-job-left">
                        <div class="jobs-item-top">
                            <div class="job-profile">
                                <img class="profile-img" src="${snapshot.val().image}" alt="">
                                <ul>
                                    <li class="profile-title">${snapshot.val().role}</li>
                                    <li class="profile-link">${snapshot.val().company} <a href="${snapshot.val().link}"> ${snapshot.val().link}</a></li>
                                    <li><img src="assets/icons/cube.png" alt=""> ${snapshot.val().stage}</li>
                                    <li><img src="assets/icons/location.png" alt=""> Remote: ${snapshot.val().remote}</li>
                                </ul>
                            </div>
                        </div>
                        <div class="jobs-item-bottom">
                            <h4>${snapshot.val().title}</h4>
                            <p>
                                ${snapshot.val().description}
                            </p>
                        </div>
                    </div>
                    <div class="user-job-right">
                        <h4 class="user-dropdown-title">. <img src="../assets/icons/down.png" alt=""></h4>
                        <ul class="user-dropdown" hidden>
                            <li></li>
                            <li>Initial Meeting</li>
                            <li>Interviewing</li>
                            <li class="status-link">Paused</li>
                            <li class="status-link">Not a Fit</li>
                            <li class="status-link">Got an Offer</li>
                            <li>Turned Down Offer</li>
                            <li>Accepted Offer</li>
                        </ul>
                    </div>
                </div> -->
            </div>

        </div>
        
        <div class="user-jobs user-past" hidden>
            
            <h2 class="jobs-title">Past Opportunities</h2>
            <h5 class="user-jobs-subtitle">* Please update status of opportunities based on conversations.</h5>

            <div class="jobs-items">
                
            </div>

        </div>


    </section>


    <footer>

        <div class="footer-left">
            <h2>Company</h2>
            <ul>
                <li><a class="talk" href="#">Talk to an Expert</a></li>
                <li><a href="explore.html">Jobs</a></li>
                <li><a href="index.html">Home</a></li>
                <li><a class="contact-btn" href="#">Contact Us</a></li>
            </ul>
        </div>
        <div class="footer-right">
            <h2>Stay up to date with movements in Moonhub</h2>
            <form class="popup-input" id="subscribeForm">
                <input type="text" placeholder="Your Email" required>
                <button type="submit">Join Mailing List</button>
            </form>
            <h3 class="subscribe-message">Your Email has been Added!</h3>
        </div>

    </footer>




    <div class="status-popup">
        <div class="popup-overlay"></div>

        <div class="status-container">
            <h3 class="status-title">Please tell us why this oppportunity is now <span class="popupStatus">Paused</span>.</h3>
            <h5 class="status-subtitle">Your agent will use this information to better curate future opportunities.</h5>
            <textarea class="status-textarea"></textarea>
            <div class="status-submit"><button class="status-btn">Send</button></div>
        </div>

    </div>
    
    
    <div class="apply-popup">
        <div class="popup-overlay"></div>

        <div class="status-container">
            <h3 class="status-title">Get introduced to the team at <span class="popupCompany"></span></h3>
            <h5 class="status-subtitle">Write a short note to about why youâ€™re interested in the opportunity. Weâ€™ll use this information to help you get an introduction. Youâ€™ll receive an email introduction to the hiring manager after <span class="popupCompany"></span> approves the request!</h5>
            <textarea class="status-textarea"></textarea>
            <div class="apply-choices">
                <span class="choices-label">I am:</span>
                <div class="choices-container">
                    <span class="apply-choice">
                        <div class="apply-checkbox"></div>
                        <div class="apply-text">Ready to interview</div>
                    </span>
                    <span class="apply-choice">
                        <div class="apply-checkbox"></div>
                        <div class="apply-text">Interested in interviewing, but want to learn more first</div>
                    </span>
                    <span class="apply-choice">
                        <div class="apply-checkbox"></div>
                        <div class="apply-text">Just curious</div>
                    </span>
                </div>
            </div>
            <div class="status-submit"><button class="status-btn">Send</button></div>
        </div>

    </div>

    <div class="popup-contact">
        <div class="popup-overlay"></div>
        <div class="popup-container">
            <h2>Contact the Moonhub Team</h2>
            <form class="contact-form" id="contactForm">
                <input id="contactName" type="text" placeholder="Full Name">
                <input id="contactEmail" type="email" placeholder="Email">
                <textarea id="contactMessage" placeholder="Message"></textarea>
                <button type="submit">Send</button>
                <h3 id="contactMsg">Message Sent.</h3>
            </form>
        </div>
    </div>

    <div class="popup">
        <div class="popup-overlay"></div>
        <div class="popup-container">
            <h2><strong>Invite </strong> Code</h2>
            <p>
                Use your invite code to get matched to start-ups. <strong> Donâ€™t have a code but want to join Moonhub & meet top startups? </strong> Email <strong class="c-blk"> hello@moonhub.xyz </strong> with your resume or LI to get a referral! 
            </p>
            <form class="popup-input" id="codeForm">
                <input type="text" id="codeInput" placeholder="Your invite code" required>
                <button type="submit"><img src="assets/icons/right.png" alt=""></button>
            </form>
            <h5 class="code-error">The Code is Incorrect.</h5>
        </div>
    </div>

    <div class="popup-startups">
        <div class="popup-overlay"></div>
        <div class="popup-container">
            <h2><strong> Hire </strong> Top Talent</h2>
            <p>
                Moonhub represents the world's best <strong>engineers, product maagers, designers, </strong> etc in their job search. Email <strong class="c-blk">hello@moonhub.xyz</strong> to learn how you can start scaling your company with top-notch talent through Moonhub.
            </p>
        </div>
    </div>

    <div class="popup-community">
        <div class="popup-overlay"></div>
        <div class="popup-container">
            <h2>Moonhub <strong> x(Community)</strong></h2>
            <p>
                Get an <strong> invite code </strong> for your community! Moonhub partners with the worldâ€™s best <strong> tech forums, VCs, alumni groups, diversity initiatives, ++ </strong> to give members startup opportunities. Earn $ every time your x(Community) invite code is used to find a job on Moonhub. Email <strong class="c-blk"> hello@moonhub.xyz </strong> to learn more and get started. 
            </p>
        </div>
    </div>
    
    <div class="popup-job">
        <div class="popup-overlay"></div>
        <div class="jobs-item popup-job-container">
            <div class="jobs-item-top">
                <div class="job-profile">
                    <img class="profile-img job-popup-img" src="" alt="">
                    <ul>
                        <li class="profile-title job-popup-role"></li>
                        <li class="profile-link"><span class="job-popup-company"> </span> <a class="job-popup-link" href="${snapshot.val().link}"> </a></li>
                        <li><img src="assets/icons/cube.png" alt=""><span class="job-popup-stage"></span></li>
                        <li><img src="assets/icons/location.png" alt=""> Remote: <span class="job-popup-remote"></span></li>
                    </ul>
                </div>
                <a href="#" class="profile-btn">Talk to an Expert</a>
            </div>
            <div class="jobs-item-bottom">
                <h4 class="job-popup-title"></h4>
                <p class="job-popup-description">
                    
                </p>
            </div>
        </div>
    </div>

    <div class="popup-send">
        <div class="popup-overlay"></div>
        <img class="active" src="../images/send.png" alt="">
    </div>

    <!-- <div data-tf-popover="Rf1Q0KRO" data-tf-button-color="#009ACB"
    data-tf-button-text="Launch me" data-tf-iframe-props="title=Registration Form"
    data-tf-medium="snippet" style="all:unset;"></div> -->

    <span class="mailto-btn-fixed" style="margin-left: 30px;">
        <svg class="default" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21 0H0V9L10.5743 24V16.5H21C22.6567 16.5 24 15.1567 24 13.5V3C24 1.34325 22.6567 0 21 0ZM7.5
            9.75C6.672 9.75 6 9.07875 6 8.25C6 7.42125 6.672 6.75 7.5 6.75C8.328 6.75 9 7.42125 9 8.25C9 9.07875 8.328 9.75
            7.5 9.75ZM12.75 9.75C11.922 9.75 11.25 9.07875 11.25 8.25C11.25 7.42125 11.922 6.75 12.75 6.75C13.578 6.75 14.25
            7.42125 14.25 8.25C14.25 9.07875 13.578 9.75 12.75 9.75ZM18 9.75C17.172 9.75 16.5 9.07875 16.5 8.25C16.5 7.42125
            17.172 6.75 18 6.75C18.828 6.75 19.5 7.42125 19.5 8.25C19.5 9.07875 18.828 9.75 18 9.75Z" fill="#FFFFFF"></path>
        </svg>
    </span>


    <button class="typeform-btn" data-tf-popup="Rf1Q0KRO" data-tf-iframe-props="title=Registration Form"
    data-tf-medium="snippet"
    style="all:unset;font-family:Helvetica,Arial,sans-serif;display:inline-block;max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;background-color:#009ACB;color:#FFFFFF;
    font-size:15px;border-radius:18px;padding:0
    25px;font-weight:bold;height:37.5px;cursor:pointer;line-height:37.5px;text-align:center;margin:0;text-decoration:none; display: none;">Get Introduced</button>

    <a class="out-link" href="../index.html"></a>

    <script src="assets/js/jquery.js"></script>
    <script src="assets/js/isotope.js"></script>
    <script src="https://embed.typeform.com/next/embed.js"></script>
    <script src="main.js"></script>


    <script type="module">

        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-analytics.js";
        import { getDatabase, push, ref, set, onChildAdded, child, remove, onValue, get } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-database.js";
        import { getAuth, createUserWithEmailAndPassword, onAuthStateChanged, updateProfile, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-auth.js";

        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyBexLtfFSG_UyYcGpowKXGX3IjQTDYy1xM",
          authDomain: "moonhub-8040e.firebaseapp.com",
          projectId: "moonhub-8040e",
          storageBucket: "moonhub-8040e.appspot.com",
          messagingSenderId: "1093017471320",
          appId: "1:1093017471320:web:6d50c0e710cbbedfa5bd2d",
          measurementId: "G-E6FR4KEJKZ"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const database = getDatabase();
        const auth = getAuth();


        var opps;
        var uid;
        var name;
        var userEmail;
        onAuthStateChanged(auth, (user) => {
        if (user) {
            // User is signed in, see docs for a list of available properties
            // https://firebase.google.com/docs/reference/js/firebase.User
            uid = user.uid;
            name = user.displayName
            userEmail = user.email
            // alert(user.email)
            get(child(ref(database, 'users'), uid)).then(function(snapshot) {
                opps = JSON.parse(snapshot.val().opportunities)
                opps.forEach(opp => {
                    get(child(ref(database, 'jobs'), opp.opp)).then(function(snapshot) {
                        if (opp.status !== 'Paused' && opp.status !== 'Not a Fit' && opp.status !== 'Got an Offer') {
                            $('.user-matches .jobs-items').prepend(`
                                <div data-opp="${opp.opp}" role-filter="true" stage-filter="true" sector-filter="true" location-filter="true" data-remote="${snapshot.val().remote}" class="jobs-item user-job ${snapshot.val().roleFilter} ${snapshot.val().locationFilter} ${snapshot.val().sectorFilter} ${snapshot.val().stageFilter}">
                                    <div class="user-job-left">
                                        <div class="jobs-item-top">
                                            <div class="job-profile">
                                                <img class="profile-img" src="${snapshot.val().image}" alt="">
                                                <ul>
                                                    <li class="profile-title">${snapshot.val().role}</li>
                                                    <li class="profile-link">${snapshot.val().company} <a href="${snapshot.val().link}"> ${snapshot.val().link}</a></li>
                                                    <li><img src="assets/icons/cube.png" alt=""> ${snapshot.val().stage}</li>
                                                    <li><img src="assets/icons/location.png" alt=""> Remote: ${snapshot.val().remote}</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="jobs-item-bottom">
                                            <h4>${snapshot.val().title}</h4>
                                            <p>
                                                ${snapshot.val().description}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="user-job-right">
                                        <h4 class="user-dropdown-title">${opp.status} <img src="../assets/icons/down.png" alt=""></h4>
                                        <ul class="user-dropdown" hidden>
                                            <li>Waiting for Introduction</li>
                                            <li>Initial Meeting Scheduled</li>
                                            <li>Interviewing</li>
                                            <li class="status-link">Paused</li>
                                            <li class="status-link">Not a Fit</li>
                                            <li class="status-link">Got an Offer</li>
                                            <li>Turned Down Offer</li>
                                            <li>Accepted Offer</li>
                                        </ul>
                                    </div>
                                </div>
                            `)
                        } else {
                            $('.user-past .jobs-items').prepend(`
                                <div data-opp="${opp.opp} role-filter="true" stage-filter="true" sector-filter="true" location-filter="true" data-remote="${snapshot.val().remote}" class="jobs-item user-job ${snapshot.val().roleFilter} ${snapshot.val().locationFilter} ${snapshot.val().sectorFilter} ${snapshot.val().stageFilter}">
                                    <div class="user-job-left">
                                        <div class="jobs-item-top">
                                            <div class="job-profile">
                                                <img class="profile-img" src="${snapshot.val().image}" alt="">
                                                <ul>
                                                    <li class="profile-title">${snapshot.val().role}</li>
                                                    <li class="profile-link">${snapshot.val().company} <a href="${snapshot.val().link}"> ${snapshot.val().link}</a></li>
                                                    <li><img src="assets/icons/cube.png" alt=""> ${snapshot.val().stage}</li>
                                                    <li><img src="assets/icons/location.png" alt=""> Remote: ${snapshot.val().remote}</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="jobs-item-bottom">
                                            <h4>${snapshot.val().title}</h4>
                                            <p>
                                                ${snapshot.val().description}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="user-job-right">
                                        <h4 class="user-dropdown-title">${opp.status} <img src="../assets/icons/down.png" alt=""></h4>
                                        <ul class="user-dropdown" hidden>
                                            <li>Turned Down Offer</li>
                                            <li>Accepted Offer</li>
                                            <li class="status-link">Paused</li>
                                            <li class="status-link">Not a Fit</li>
                                        </ul>
                                    </div>
                                </div>
                            `)

                        }
                    })
                });

                $(document).on('click', '.user-dropdown li', function() {
                    var option = $(this).text()
                    var oppKey = $(this).parents('.jobs-item').attr('data-opp')
                    var arrOpp = opps.findIndex((opp => opp.opp == oppKey));

                    opps[arrOpp].status = option
                    $(this).parents('.user-view-right').find('h4').html(option)
                    $(this).parent().slideUp(200)
                    
                    set(child(ref(database, 'users'), uid), {
                        email: user.email,
                        name: name,
                        opportunities: JSON.stringify(opps)
                    })

                })
            })

            $('.userName').text(name)

            // ...
        } else {
            // User is signed out
            // ...
            $('.out-link')[0].click()
        }
        });

        
        

        onChildAdded(ref(database, 'jobs'), (snapshot) => {
            $('.user-news .jobs-items').prepend(`
                <div data-key="${snapshot.key}" role-filter="true" stage-filter="true" sector-filter="true" location-filter="true" data-remote="${snapshot.val().remote}" class="jobs-item user-job-item ${snapshot.val().roleFilter} ${snapshot.val().locationFilter} ${snapshot.val().sectorFilter} ${snapshot.val().stageFilter}">
                    <div class="jobs-item-top">
                        <div class="job-profile">
                            <img class="profile-img" src="${snapshot.val().image}" alt="">
                            <ul>
                                <li class="profile-title">${snapshot.val().role}</li>
                                <li class="profile-link"><span class="newsCompany">${snapshot.val().company} </span>: <a href="${snapshot.val().link}"> ${snapshot.val().link}</a></li>
                                <li><img src="assets/icons/cube.png" alt=""> ${snapshot.val().stage}</li>
                                <li><img src="assets/icons/location.png" alt=""> Remote: ${snapshot.val().remote}</li>
                            </ul>
                        </div>
                        <a href="#" class="profile-btn apply-link">ðŸ‘‹ Request Introduction</a>
                    </div>
                    <div class="jobs-item-bottom">
                        <h4>${snapshot.val().title}</h4>
                        <p>
                            ${snapshot.val().description}
                        </p>
                    </div>
                </div>
            `)
        })



        $('.search-container').submit(function(e) {
            e.preventDefault()
            var value = $('.search-container input').val().toLowerCase();


            $('.jobs-item').hide()
            $('.jobs-item').each(function() {
                if ($(this).attr('role-filter') == 'true' && $(this).attr('stage-filter') == 'true' && $(this).attr('sector-filter') == 'true' && $(this).attr('location-filter') == 'true' && $(this).text().indexOf(value) > -1) {
                    $(this).show()
                } else {

                }
            })
            

        })



        $('#codeForm').submit(function(e) {
            e.preventDefault()
            if ($('#codeInput').val() !== '') {
                var id = $('#codeInput').val()
                onChildAdded(ref(database, 'emails'), (snapshot) => {
                    if (snapshot.val().code == id) {
                        $('.typeform-btn').click()
                    } else {
                        //
                    }
                })
            } else {

            }
        })

        if (localStorage.getItem('search') !== null) {
            $('.search-container input').val(localStorage.getItem('search'))

            $('.filter a').each(function() {
                if ($(this).text() == localStorage.getItem('search')) {
                    $(this).addClass('active')
                } else {

                }
            })
                
            localStorage.clear()
        } else {
            //
        }
        
        onValue(ref(database, 'jobs'), (snapshot) => {
            $('.search-container').submit()
        })

    

        $('.role-filters a').click(function(e) {
            e.preventDefault()

            $(this).toggleClass('active')
            $('.jobs-item').hide()
            
            $('.jobs-item').attr('role-filter', 'false')
            $('.role-filters a.active').each(function() {
                $(`.${$(this).attr('data-filter')}`).attr('role-filter', 'true')
            })

            if ($('.role-filters a.active').length == 0) {
                $('.jobs-item').attr('role-filter', 'true')
            } else {

            }
        })


        $('.stage-filters a').click(function(e) {
            e.preventDefault()

            $(this).toggleClass('active')
            $('.jobs-item').hide()

            $('.jobs-item').attr('stage-filter', 'false')
            $('.stage-filters a.active').each(function() {
                $(`.${$(this).attr('data-filter')}`).attr('stage-filter', 'true')
            })

            if ($('.stage-filters a.active').length == 0) {
                $('.jobs-item').attr('stage-filter', 'true')
            } else {

            }
        })


        $('.sector-filters a').click(function(e) {
            e.preventDefault()

            $(this).toggleClass('active')
            $('.jobs-item').hide()

            $('.jobs-item').attr('sector-filter', 'false')
            $('.sector-filters a.active').each(function() {
                $(`.${$(this).attr('data-filter')}`).attr('sector-filter', 'true')
            })

            if ($('.sector-filters a.active').length == 0) {
                $('.jobs-item').attr('sector-filter', 'true')
            } else {

            }
        })


        $('.location-filters a').click(function(e) {
            e.preventDefault()

            $(this).toggleClass('active')
            $('.jobs-item').hide()

            $('.jobs-item').attr('location-filter', 'false')
            $('.location-filters a.active').each(function() {
                $(`.${$(this).attr('data-filter')}`).attr('location-filter', 'true')
            })

            if ($('.location-filters a.active').length == 0) {
                $('.jobs-item').attr('location-filter', 'true')
            } else {

            }
        })


        $('.filter a').click(function(e) {
            e.preventDefault()

            var value = $('.search-container input').val()

            $('.jobs-item').hide()
            $('.jobs-item').each(function() {
                if ($(this).attr('role-filter') == 'true' && $(this).attr('stage-filter') == 'true' && $(this).attr('sector-filter') == 'true' && $(this).attr('location-filter') == 'true' && $(this).text().indexOf(value) > -1) {
                    $(this).show()
                } else {

                }
            })
        })


        $('.switch').click(function() {
            var value = $('.search-container input').val()
            if ($(this).attr('data-remote') == 'no') {
                $('.jobs-item').hide()
                $('.jobs-item').each(function() {
                    if ($(this).attr('role-filter') == 'true' && $(this).attr('stage-filter') == 'true' && $(this).attr('sector-filter') == 'true' && $(this).attr('location-filter') == 'true' && $(this).attr('data-remote') == 'Yes' && $(this).text().indexOf(value) > -1) {
                        $(this).show()
                    } else {

                    }
                })
                $(this).attr('data-remote', 'yes')
            } else {
                $('.jobs-item').hide()
                $('.jobs-item').each(function() {
                    if ($(this).attr('role-filter') == 'true' && $(this).attr('stage-filter') == 'true' && $(this).attr('sector-filter') == 'true' && $(this).attr('location-filter') == 'true' && $(this).attr('data-remote') == 'No' && $(this).text().indexOf(value) > -1) {
                        $(this).show()
                    } else {

                    }
                })
                $(this).attr('data-remote', 'no')
            }
        })


        var emails;
        get(ref(database, 'emails')).then((snapshot) => {
            emails = snapshot
        })


        $('#codeForm').submit(function(e) {
            e.preventDefault()
            var exist = false
            if ($('#codeInput').val() !== '') {
                var id = $('#codeInput').val()
                $('.code-error').text('Checking...').fadeIn()

                emails.forEach(email => {
                    if (email.val().code == id) {
                        exist = true
                    } else {
                        //
                    }
                });

                setTimeout(() => {
                    
                    if (exist == false) {
                        $('.code-error').text('Your Code is Incorrect')
                        setTimeout(() => {
                            $('.code-error').fadeOut()
                        }, 2000);
                    } else {
                        $('.calendly-badge-content').click()
                        $('.code-error').fadeOut()
                    }

                }, 1000);


            } else {

            }
        })

        var key;
        $(document).on('click', '.apply-link', function() {
            key = $(this).parents('.jobs-item').attr('data-key')
        })
        
        $('.status-submit').click(function() {
            opps.push({opp: key, status: 'Waiting for Introduction'})
            set(child(ref(database, 'users'), uid), {
                email: userEmail,
                name: name,
                opportunities: JSON.stringify(opps)
            })

            $('.apply-popup').fadeOut()
            $('.popup-send').fadeIn()
            setTimeout(() => {
                $('.popup-send').fadeOut()
            }, 200)


            get(child(ref(database, 'users'), uid)).then(function(snapshot) {
                opps = JSON.parse(snapshot.val().opportunities)
                opps.forEach(opp => {
                    get(child(ref(database, 'jobs'), opp.opp)).then(function(snapshot) {
                        if (opp.status !== 'Paused' && opp.status !== 'Not a Fit' && opp.status !== 'Got an Offer') {
                            $('.user-matches .jobs-items').html('')
                            $('.user-matches .jobs-items').prepend(`
                                <div data-opp="${opp.opp}" role-filter="true" stage-filter="true" sector-filter="true" location-filter="true" data-remote="${snapshot.val().remote}" class="jobs-item user-job ${snapshot.val().roleFilter} ${snapshot.val().locationFilter} ${snapshot.val().sectorFilter} ${snapshot.val().stageFilter}">
                                    <div class="user-job-left">
                                        <div class="jobs-item-top">
                                            <div class="job-profile">
                                                <img class="profile-img" src="${snapshot.val().image}" alt="">
                                                <ul>
                                                    <li class="profile-title">${snapshot.val().role}</li>
                                                    <li class="profile-link">${snapshot.val().company} <a href="${snapshot.val().link}"> ${snapshot.val().link}</a></li>
                                                    <li><img src="assets/icons/cube.png" alt=""> ${snapshot.val().stage}</li>
                                                    <li><img src="assets/icons/location.png" alt=""> Remote: ${snapshot.val().remote}</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="jobs-item-bottom">
                                            <h4>${snapshot.val().title}</h4>
                                            <p>
                                                ${snapshot.val().description}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="user-job-right">
                                        <h4 class="user-dropdown-title">${opp.status} <img src="../assets/icons/down.png" alt=""></h4>
                                        <ul class="user-dropdown" hidden>
                                            <li>Waiting for Introduction</li>
                                            <li>Initial Meeting Scheduled</li>
                                            <li>Interviewing</li>
                                            <li class="status-link">Paused</li>
                                            <li class="status-link">Not a Fit</li>
                                            <li class="status-link">Got an Offer</li>
                                            <li>Turned Down Offer</li>
                                            <li>Accepted Offer</li>
                                        </ul>
                                    </div>
                                </div>
                            `)
                        } else {
                            $('.user-past .jobs-items').prepend(`
                                <div data-opp="${opp.opp} role-filter="true" stage-filter="true" sector-filter="true" location-filter="true" data-remote="${snapshot.val().remote}" class="jobs-item user-job ${snapshot.val().roleFilter} ${snapshot.val().locationFilter} ${snapshot.val().sectorFilter} ${snapshot.val().stageFilter}">
                                    <div class="user-job-left">
                                        <div class="jobs-item-top">
                                            <div class="job-profile">
                                                <img class="profile-img" src="${snapshot.val().image}" alt="">
                                                <ul>
                                                    <li class="profile-title">${snapshot.val().role}</li>
                                                    <li class="profile-link">${snapshot.val().company} <a href="${snapshot.val().link}"> ${snapshot.val().link}</a></li>
                                                    <li><img src="assets/icons/cube.png" alt=""> ${snapshot.val().stage}</li>
                                                    <li><img src="assets/icons/location.png" alt=""> Remote: ${snapshot.val().remote}</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="jobs-item-bottom">
                                            <h4>${snapshot.val().title}</h4>
                                            <p>
                                                ${snapshot.val().description}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="user-job-right">
                                        <h4 class="user-dropdown-title">${opp.status} <img src="../assets/icons/down.png" alt=""></h4>
                                        <ul class="user-dropdown" hidden>
                                            <li>Turned Down Offer</li>
                                            <li>Accepted Offer</li>
                                            <li class="status-link">Paused</li>
                                            <li class="status-link">Not a Fit</li>
                                        </ul>
                                    </div>
                                </div>
                            `)

                        }
                    })
                });

                
            })

        })



        $('.contact-btn').click(function(e) {
            e.preventDefault()

            $('.popup-contact').fadeIn()
        })


        $('#contactForm').submit(function(e) {
            e.preventDefault()

            var templateParams = {
                name: $('#contactName').val(),
                email: $('#contactEmail').val(),
                message: $('#contactMessage').val()
            };
            
            emailjs.send('service_ezlgjj4', 'template_bz22ss8', templateParams)
                .then(function(response) {
                console.log('SUCCESS!', response.status, response.text);
                $('#contactMsg').fadeIn()
                setTimeout(() => {
                    $('#contactMsg').fadeOut()
                }, 2000);
                }, function(error) {
                console.log('FAILED...', error);
                });

        })


      </script>
</body>
</html>